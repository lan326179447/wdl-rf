# wdl-rf
Predicting Bioactivities of Ligands Acting with G Protein-coupled Receptors by a Novel Weighted Deep Learning

Inroduction:
In commercial drug design, virtual screening is only acceptable if the prediction accuracy is high. 
Motivated by the success of deep learning on virtual screening (Duvenaud, et al., 2015; Unterthiner, et al., 2014), 
a deep learning algorithm will be designed to predict the bioactivities of ligands acting with GPCRs. 
One difficulty with this task is that the input to the model, a ligand, can be of arbitrary size. 
Currently, deep learning pipelines can only handle inputs of a fixed size. 
Our proposed two-stage algorithm WDL-RF allows end-to-end learning of prediction pipelines whose inputs are of arbitrary size,
which contains the molecular fingerprint generation stage through a new weighted deep learning method and the bioactivity prediction stage by the random forest model. 
The results indicate that our algorithm WDL-RF achieves the best performance in the prediction of ligand bioactivities in seven human GPCR (no three-dimensional structure)
drug target datasets, probably suggesting our algorithm has great prospects in drug development. 
Moreover, the data-driven molecular fingerprint features which are generated by our proposed weighted deep learning 
solves the deficiency of traditional hand-crafted features and makes up the insufficiency of short molecular fingerprints in drug design.

The website:  https://github.com/njuptml/wdl-rf.

These programs requires:
Scipy version >= 0.15.0
[RDkit](http://www.rdkit.org/docs/Install.html) 
[Autograd](http:github.com/HIPS/autograd) (Just run `pip install autograd`)

Our runing environment: window10 and python2.7 

Our codes had three functions as below. 
 (1) demo_new: This provides a general framework on ligand-based virtual screening, and it is easy for users to develop their own virtual screening tools for their interest drug targets on the basis of our codes. Input: Compounds in the format of SMILES and their bioactivity values. Output: Model performance (RMSE, r2 and q2). The procedure is as follows: To input compounds in the format of SMILES and theirs bioactivity values →To train the weighted deep learning model →To get the weighted molecular fingerprints →To construct random forest regression models → To obtain the model performance.
（2）demo_ activity: This offers the ligand-based virtual screening models of seven important human GPCR drug targets, and users can predict the bioactivities of new compounds acting with these targets, which is important to the new drug design against these drug targets, the prediction of side effects of multi-target drugs, and the risk assessment of drug development, etc. Input: Compounds in the format of SMILES. Output: Bioactivity values interacting with these GPCR drug targets. The steps are as below: To input compounds in the format of SMILES →To get the weighted molecular fingerprints by our trained weighted deep learning models →To obtain the bioactivity values based on our trained random forest models.
（3）demo_fp: Users can obtain multiple types of short molecular fingerprints for a compound, which can be used in compound similarity search, pharmacophore search and bioactivity prediction, etc. Input: Compounds in the format of SMILES. Output: Molecular fingerprints. The steps are as follows: To input compounds in the format of SMILES →To obtain molecular fingerprints based on our trained weighted deep learning models. For each GPCR drug target, five types of short molecular fingerprints are produced for a compound. Therefore, the total 35 (7×5) kinds of different molecular fingerprints will be generated for each compound.
